import matplotlib.pyplot as plt
import numpy as np

# Network loads
utilizations = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]

# Data for each distribution and flow size
data = {
    'uniform': {
        'all': {
            'conga': [1160.85, 1672.57, 2626.83, 4857.40, 31419.33, 417117.90, 579861.16, 674513.20, 735934.14, 775484.68],
            'ecmp': [1162.14, 1693.70, 2705.92, 5170.87, 24053.73, 413501.72, 577079.23, 671885.19, 733350.85, 773383.84]
        },
        'small': {
            'conga': [1160.85, 1672.57, 2626.83, 4857.40, 31419.33, 417117.90, 579861.16, 674513.20, 735934.14, 775484.68],
            'ecmp': [1162.14, 1693.70, 2705.92, 5170.87, 24053.73, 413501.72, 577079.23, 671885.19, 733350.85, 773383.84]
        },
        'large': {
            'conga': [1160.85, 1672.57, 2626.83, 4857.40, 31419.33, 417117.90, 579861.16, 674513.20, 735934.14, 775484.68],
            'ecmp': [1162.14, 1693.70, 2705.92, 5170.87, 24053.73, 413501.72, 577079.23, 671885.19, 733350.85, 773383.84]
        }
    },
    'pareto': {
        'all': {
            'conga': [1356.79, 2212.96, 3293.85, 4675.02, 6160.22, 8326.30, 11166.32, 15190.36, 24882.97, 34816.45],
            'ecmp': [1348.15, 2201.03, 3305.90, 4662.65, 6520.37, 8955.71, 12351.00, 17733.36, 26215.78, 35012.44]
        },
        'small': {
            'conga': [904.66, 1658.08, 2597.42, 3778.63, 5040.53, 6816.01, 9135.93, 12401.72, 20539.57, 28670.08],
            'ecmp': [901.39, 1651.45, 2611.03, 3771.36, 5326.11, 7338.62, 10112.13, 14538.15, 21559.61, 28704.77]
        },
        'large': {
            'conga': [7213.73, 9431.77, 12426.45, 16385.94, 20874.67, 28234.33, 38141.09, 52551.80, 84781.68, 124253.52],
            'ecmp': [7174.11, 9348.35, 12347.83, 16299.43, 22152.87, 30231.42, 41972.45, 60648.75, 90533.79, 127743.62]
        }
    },
    'enterprise': {
        'all': {
            'conga': [2825.69, 3845.69, 4962.55, 6034.69, 7137.42, 8192.84, 9316.26, 10524.58, 11912.77, 13633.76],
            'ecmp': [2633.11, 3691.34, 4827.70, 5950.35, 7144.83, 8360.73, 9674.64, 11019.29, 12472.79, 14035.15]
        },
        'small': {
            'conga': [849.52, 1503.84, 2211.37, 2825.70, 3520.85, 4127.41, 4809.91, 5539.71, 6407.48, 7542.04],
            'ecmp': [808.04, 1450.69, 2161.96, 2858.00, 3571.74, 4320.23, 5114.89, 5945.14, 6880.69, 7929.57]
        },
        'large': {
            'conga': [35899.29, 43243.27, 51053.81, 60459.04, 69737.14, 79404.76, 89688.58, 100782.69, 113705.97, 129031.88],
            'ecmp': [33362.03, 41124.82, 49598.98, 58918.69, 69107.08, 79302.18, 91217.95, 103718.12, 116771.39, 130147.68]
        }
    },
    'datamining': {
        'all': {
            'conga': [13182.02, 14995.99, 15398.34, 16636.12, 16914.85, 17143.11, 17155.25, 16853.49, 17148.77, 17551.04],
            'ecmp': [8384.19, 11576.82, 13516.76, 14405.36, 15168.68, 15054.92, 15092.27, 15031.60, 15079.19, 15329.54]
        },
        'small': {
            'conga': [250.34, 771.32, 811.79, 1045.95, 1188.37, 1342.29, 1587.07, 1648.15, 1788.89, 1868.31],
            'ecmp': [325.33, 590.86, 795.32, 941.35, 1173.06, 1243.68, 1373.25, 1484.84, 1596.83, 1710.02]
        },
        'large': {
            'conga': [88713.92, 94853.42, 95660.26, 105238.50, 107476.67, 109379.79, 108812.28, 108121.65, 108818.62, 111448.62],
            'ecmp': [59112.34, 78996.31, 90731.06, 95981.46, 99000.50, 98312.16, 99450.88, 98948.56, 98840.40, 99503.92]
        }
    }
}

def plot_ratio(distribution, flow_size, ax):
    conga_data = data[distribution][flow_size]['conga']
    ecmp_data = data[distribution][flow_size]['ecmp']
    
    # Calculate ratio
    ratio = [c/e for c, e in zip(conga_data, ecmp_data)]
    
    # Plot ratio line
    ax.plot(utilizations, ratio, 'b-', label='CONGA/ECMP Ratio', marker='o', markersize=4)
    # Plot baseline
    ax.plot(utilizations, [1.0] * len(utilizations), 'g--', label='ECMP Baseline')
    
    ax.set_xlabel('Network Load')
    ax.set_ylabel('CONGA/ECMP Ratio')
    ax.set_title(f'{distribution.capitalize()} Distribution - {flow_size.capitalize()} Flows')
    ax.grid(True, linestyle='--', alpha=0.7)
    ax.legend()
    ax.set_ylim([0.5, 1.6])

# Create plots
fig = plt.figure(figsize=(20, 15))
fig.suptitle('CONGA vs ECMP Performance Comparison', fontsize=16)

distributions = ['uniform', 'pareto', 'enterprise', 'datamining']
flow_sizes = ['all', 'small', 'large']

# Create 12 subplots
for i, dist in enumerate(distributions):
    for j, size in enumerate(flow_sizes):
        ax = plt.subplot(4, 3, i*3 + j + 1)
        plot_ratio(dist, size, ax)

plt.tight_layout(rect=[0, 0.03, 1, 0.95])
plt.savefig('result.png')
plt.show()
